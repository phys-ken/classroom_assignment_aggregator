# Google Classroom 課題集計ツール (Classroom Assignment Aggregator)

Googleスプレッドシート上で動作し、Google Classroomの課題提出状況を自動で集計・分析するためのツールです。

## 概要

このツールは、Google Classroomのクラスが複数あり、生徒の課題提出状況を一覧で確認・集計したい先生向けのスクリプトです。スプレッドシートにメニューが追加され、簡単な操作で以下の機能を利用できます。

## 主な機能

- **クラス一覧の取得**: 参加しているアクティブなクラスを自動でシートに書き出します。
- **課題と提出状況の取得**: 選択したクラスの全課題と、全生徒の提出状況（スコアなど）を一覧化します。
- **評価方法のカスタマイズ**: 課題の評価方法を「3段階評価」「提出チェックのみ」「得点率」など、柔軟に設定できます。
- **スコアの自動集計**: 生徒ごとにスコア、得点率、未提出数などを自動で計算し、サマリーシートを作成します。

## 使い方

このスクリプトは、紐づけられたGoogleスプレッドシートから利用します。

1.  **スプレッドシートを開く**: スクリプトが紐づいたスプレッドシートを開きます。
2.  **カスタムメニュー**: 上部に `Classroom Tools` という専用メニューが表示されます。
3.  **各機能の実行**:
    1.  **`1. Get All Classes`**: まずこれを実行し、`classes`シートに対象クラスの一覧を読み込みます。
    2.  **`2. Get Assignments`**: `classes`シートで集計したいクラスにチェックを入れ、これを実行します。`assignment`シートに全課題データが展開されます。（初回実行時は、評価方法を設定する`setting`シートが作成されます）
    3.  **`3. Aggregate Scores`**: `assignment`シートのデータを元に、集計ダイアログが開きます。集計したいクラスや課題を選択し、新しいサマリーシートを作成します。
    4.  **`HELP`**: 各機能の使い方を説明するダイアログが表示されます。

## ご利用にあたっての注意

- このスクリプトはGoogleスプレッドシートに紐づけて使用する必要があります。
- 初回利用時など、Googleアカウントによる承認（権限の付与）が必要です。
- Google Classroom APIを有効にする必要があります。
- 本ツールの利用によって生じたいかなる不具合や損害についても、作成者は一切の責任を負いません。自己責任でご利用ください。

---

## 開発者向け情報 (Technical Details)

### 主要な関数と処理概要

- `onOpen()`: スプレッドシートを開いたときにカスタムメニューを生成します。
- `getAllClasses()`: Classroom APIを利用して、`teacherId: 'me'`の有効なクラスを取得し、`classes`シートに書き出します。
- `getAssignments()`: `getAssignmentsCore_()`のラッパー関数。UIを介して確認ダイアログなどを表示します。
- `getAssignmentsCore_()`: `classes`シートで選択されたクラスの課題と全生徒の提出状況をClassroom APIから取得し、`assignment`シートに整形して出力します。この際、`setting`シートの評価設定に基づき`Flag`列を計算します。
- `showAggregateDialog()`: `assignment`シートのデータから集計対象のクラスや課題をリストアップし、UIダイアログを生成します。
- `aggregateScores_()`: ダイアログで選択された条件に基づき、生徒ごとのスコア、得点率、未提出率などを集計し、指定されたサマリーシートに出力します。

### ローカル開発環境 (clasp)

このプロジェクトは[clasp](https://github.com/google/clasp)を使用してローカルでの開発とGoogle Apps Scriptサーバーとの同期を行っています。

```bash
# claspでプロジェクトをクローン
clasp clone [SCRIPT_ID]

# ローカルの変更をGASにプッシュ
clasp push

# GASの変更をローカルにプル
clasp pull
```

## サポート・連絡先

ご不明な点や改善要望がありましたら、下記までご連絡ください。

- [お問い合わせ (開発者: phys-ken)](https://note.com/phys_ken)

## ライセンス

MIT License

## Pages_theme
remote_theme: pages-themes/architect@v0.2.0


